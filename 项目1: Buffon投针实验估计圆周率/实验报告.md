
# 实验报告：Buffon 投针实验估计 $\pi$ 值

**学生姓名：** 叶瑞昀

**学号：** 20231050034 

**完成日期：** 20250625

## 一、实验目的
编写程序，利用 Buffon 投针实验来估计 $\pi$ 的值，并分析实验次数对估计精度的影响。

## 二、实验原理
简要描述 Buffon 投针实验的原理，包括投针概率与 $\pi$ 的关系公式。

Buffon 投针实验是一种经典的概率方法，用于估算圆周率 $\pi$。其原理如下：

假设在一组间距为 $d$ 的平行线上，随机投掷长度为 $l$（ $l \leq d$）的针。每次投掷，针有可能与某一条平行线相交。经过大量实验，统计针与线相交的次数 $N_{\text{hit}}$ 与总投掷次数 $N$，可以得到针相交的概率 $P$：

$$
P = \frac{2l}{d\pi}
$$

实验中， $P$ 也可以用 $N_{\text{hit}}/N$ 近似表示。由此可以推导出圆周率的估算公式：

$$
\pi \approx \frac{2lN}{dN_{\text{hit}}}
$$

通过大量重复实验，利用上述公式即可用概率方法估算 $\pi$ 的值。

## 三、实验环境
### 3.1 硬件环境
- 计算机型号：LENOVO 82YA（联想）
- CPU：13th Gen Intel(R) Core(TM) i5-13500H（16 核心，主频约 2.6GHz）
- 内存：16GB（16384MB RAM）


---

### 3.2 软件环境
- 操作系统：Windows 11 家庭中文版 64 位（版本 26100）
- 编程语言：Python 3.x
- 开发工具：PyCharm、Visual Studio Code
- 主要库：numpy、matplotlib
## 四、实验步骤
### 4.1 投针实验模拟逻辑实现
详细描述实现投针实验模拟逻辑的步骤，可附上关键代码片段。

实现 Buffon 投针实验模拟的主要步骤如下：

1. **初始化参数**  
   设置实验的总次数 `num_trials`，针的长度 `needle_length`，以及平行线之间的距离 `line_spacing`。

2. **重复实验**  
   对每一次实验，随机生成针中心到最近一条线的距离 $y$（范围 $[0, d/2]$），以及针与平行线夹角 $\theta$（范围 $[0, \pi/2]$）。

3. **判断是否相交**  
   如果针的一半长度在垂直方向上的投影大于等于 $y$，则认为针与线相交。

4. **统计相交次数**  
   记录所有实验中针与线相交的总次数 `hits`。

5. **计算圆周率估计值**  
   根据公式 $\pi \approx \frac{2lN}{dN_{\text{hit}}}$ 计算圆周率的估计值。

关键代码片段如下：

```python
def buffon_needle(num_trials=10000, needle_length=1.0, line_spacing=1.0):
    hits = 0  # 相交次数

    for _ in range(num_trials):
        # 随机生成针中心到最近一条线的距离 y，范围 [0, d/2]
        y = np.random.uniform(0, line_spacing / 2)
        # 随机生成针与平行线夹角 θ，范围 [0, π/2]
        theta = np.random.uniform(0, np.pi / 2)
        # 判断针是否与线相交
        if (needle_length / 2) * np.sin(theta) >= y:
            hits += 1

    if hits == 0:
        return None  # 防止除以 0

    # 根据 Buffon 投针公式估算 π
    pi_estimate = (2 * needle_length * num_trials) / (line_spacing * hits)
    return pi_estimate
```

通过多次实验并统计误差，可以分析实验次数对估算精度的影响。
### 4.2 实验次数设置
说明实验中设置的不同实验次数，例如：100、1000、10000、100000 等。

### 4.3 运行实验并记录结果
记录每次实验得到的 $\pi$ 估计值。

## 五、实验结果
### 5.1 不同实验次数下的 $\pi$ 估计值

| 实验次数 | $\pi$ 估计值   |
|----------|---------------|
| 100      | 3.448276      |
| 1000     | 3.236246      |
| 10000    | 3.152088      |
| 100000   | 3.143666      |
### 5.2 实验结果可视化
附上不同实验次数与 $\pi$ 估计值的关系图表，可使用折线图或柱状图。
![buffon_pi_error](https://github.com/user-attachments/assets/d11cdc5a-92b4-4d15-ba5f-0c9667b1b888)


## 六、结果分析
### 6.1 实验次数对估计精度的影响
分析随着实验次数的增加， $\pi$ 估计值的变化趋势，以及估计精度的变化情况。

随着实验次数的增加， $\pi$ 的估计值逐渐趋近于真实值，估计误差明显减小。  
在实验次数较少时（如 100、300 次），由于随机性影响较大， $\pi$ 的估计值波动较大，误差较高。  
而当实验次数增加到几千、几万甚至十万次时， $\pi$ 的估计值逐步稳定，误差显著降低，结果更加接近真实的圆周率。  
从对数坐标下的误差曲线也可以看出，误差随实验次数增加呈下降趋势，说明实验次数越多，估计精度越高。  
这体现了大数定律：实验次数越多，统计结果越接近理论值。
### 6.2 误差来源分析
讨论实验中可能存在的误差来源，如随机数生成的质量、模拟逻辑的近似等。

在 Buffon 投针实验的模拟过程中，估算  $\pi$ 的结果会受到多种误差来源的影响，主要包括：

1. **随机性误差**  
   由于实验本质上是基于概率的蒙特卡洛方法，每次实验的结果都具有随机性。实验次数较少时，偶然性影响较大，导致估算值波动较大，误差较高。

2. **随机数生成器的质量**  
   程序中使用伪随机数生成器（如 `numpy.random.uniform`），其随机性有限。如果随机数生成器的质量不高，可能导致实验结果偏离理论值。

3. **模拟逻辑的近似**  
   实验中假设针的长度不大于平行线间距，且每次投掷都是完全独立且均匀分布的。如果模拟逻辑实现有误或未严格遵循理论假设，也会引入系统性误差。

4. **有限实验次数**  
   理论上，实验次数趋于无穷大时，估算值才会无限接近真实值。实际模拟中实验次数有限，必然存在统计误差。

5. **浮点数精度误差**  
   计算过程中涉及大量浮点数运算，可能会有微小的数值精度误差，但通常影响较小。

综上，实验误差主要来源于随机性、实验次数、随机数生成器质量以及模拟实现的近似。增加实验次数、优化随机数生成器和严格实现理论模型可以有效减小误差。
## 七、实验结论
总结实验结果，说明 Buffon 投针实验是否能够有效估计  $\pi$ 的值，以及实验次数对估计精度的影响是否符合预期。

通过本次 Buffon 投针实验的模拟，可以发现该方法能够有效地估计圆周率 $\pi$ 的值。实验结果显示，随着实验次数的增加， $\pi$ 的估计值逐渐趋近于真实值，估计误差明显减小。这与概率统计中的大数定律相符，即实验次数越多，统计结果越接近理论值。  
因此，Buffon 投针实验不仅验证了概率方法在实际问题中的应用，也说明了实验次数对估计精度的显著影响。总体来看，该实验方法能够较为准确地估算  $\pi$，且实验次数越多，估计结果越稳定、精度越高，符合预期。


        
